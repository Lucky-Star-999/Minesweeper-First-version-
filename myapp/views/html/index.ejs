<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


    <title>Minesweeper</title>

    <style>
        /*body{
            background-color: #def3fd;
        }*/
        body {
            background-color: blue;
        }

        .hoverable {
            background-color: #73c2fb;
            cursor: pointer;
            border-radius: 5px;
            margin: 2px;
        }


        #board {
            background-color: green;
        }

        .flag_on {
            background-color: pink;
            background-image: url('../images/flag.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: contain;
        }

        .hoverable:hover {
            background-color: greenyellow;
        }


        .active.bomb {
            border-radius: 5px;
            margin: 2px;
            background-image: url('../images/bomb.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: contain;
        }

        .active {
            border-radius: 5px;
            margin: 2px;
            background-repeat: no-repeat;
            background-position: center center;
            background-size: contain;
        }

        .active.number_0 {
            background-image: url('../images/Number_0.png');
        }

        .active.number_1 {
            background-image: url('../images/Number_1.png');
        }

        .active.number_2 {
            background-image: url('../images/Number_2.png');
        }

        .active.number_3 {
            background-image: url('../images/Number_3.png');
        }

        .active.number_4 {
            background-image: url('../images/Number_4.png');
        }

        .active.number_5 {
            background-image: url('../images/Number_5.png');
        }

        .active.number_6 {
            background-image: url('../images/Number_6.png');
        }

        .active.number_7 {
            background-image: url('../images/Number_7.png');
        }

        .active.number_8 {
            background-image: url('../images/Number_8.png');
        }

        .active.number_9 {
            background-image: url('../images/Number_9.png');
        }
    </style>
</head>

<body>
    <div class="container-fluid d-flex justify-content-around">
        <div class="d-flex justify-content-center align-items-center mt-5 bg-secondary overflow-auto flex-nowrap"
            style="width: 900px; height: 600px;" id="boundary">


        </div>

        <div class="mt-5 card" style="width: 500px; height: 600px; background-color: aqua;" id="panel">
            <div class="card-header text-center">
                <h1>Minesweeper</h1>
            </div>

            <div class="card-body">
                <div>Timer</div>
                <div id="time_panel"></div>
            </div>

            <div class="card-body d-flex justify-content-around align-items-center">
                <button type="button" class="btn btn-success" onclick="undo_state()" id="undo_button">Undo</button>
                <button type="button" class="btn btn-primary">Leaderboard</button>
            </div>

            <div class="card-body d-flex flex-column justify-content-around align-items-center border">
                <div>Status</div>
                <div>
                    <p>Name: <span>Lucky</span></p>
                    <p>Board: <span>15x10</span></p>
                    <p>Numnber of bombs: <span>5</span></p>
                    <p>Game state: <span>Playing...</span></p>
                </div>
            </div>

            <div class="card-footer">
                <div>Instruction: </div>
                <div>Left-click to open a square</div>
                <div>Right-click to put a flag</div>
                <div>Middle-click to reveal 3x3 range</div>
            </div>
        </div>


    </div>

    <script src="../javascripts/create_board.js"></script>
    <script>
        //Remove the menu context
        $('.hoverable').bind("contextmenu", function (e) {
            return false;
        });

        //Remove the menu context
        $('#board').bind("contextmenu", function (e) {
            return false;
        });

        //Check clicking on a square
        $('.hoverable').mousedown(function (event) {
            
            switch (event.which) {
                case 1:
                    reveal_square(this.id);
                    break;
                case 2:
                    event.preventDefault();
                    if (is_first_click) {
                        reveal_square(this.id);
                    } else {
                        reveal_3x3_squares(this.id);
                    }
                    break;
                case 3:
                    $(this).toggleClass("flag_on");
                    break;
            }


            check_win_or_lose();

            let is_need_update = avoid_fake_update(this.id);

            if (is_need_update === true) {
                update_board_state();
            }
  
            active_undo_button();
        });

        //Disable wheel click on the board
        $('#board').mousedown(function (event) {
            switch (event.which) {
                case 2:
                    event.preventDefault();
            }
        });
    </script>


</body>

</html>